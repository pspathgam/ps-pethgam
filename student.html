<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Student Dashboard - Demo</title>
<style>
  :root{--accent:#0f766e;--accent2:#ff6b6b;--card:#fff;--muted:#6b7280}
  body{font-family:Inter,system-ui,Arial;margin:0;background:linear-gradient(135deg,#f0faff,#fff8f3);color:#052}
  .header{display:flex;align-items:center;gap:12px;padding:12px 18px;background:linear-gradient(90deg,var(--accent),#06b6d4);color:#fff}
  .logo{width:46px;height:46px;border-radius:8px;background:#fff;display:flex;align-items:center;justify-content:center;color:var(--accent);font-weight:800}
  .container{max-width:1000px;margin:18px auto;padding:16px}
  .card{background:var(--card);padding:14px;border-radius:12px;box-shadow:0 12px 30px rgba(2,6,23,0.06);margin-bottom:12px}
  label{display:block;margin:8px 0;font-weight:700;color:#064e47}
  input,select,textarea{width:100%;padding:10px;border-radius:10px;border:1px solid rgba(7,22,20,0.06)}
  .btn{display:inline-block;padding:10px 14px;border-radius:10px;border:none;background:linear-gradient(180deg,var(--accent),#064e47);color:#fff;font-weight:800;cursor:pointer}
  .feed-item{padding:10px;border-radius:10px;background:linear-gradient(180deg,#fff,#fbfdff);margin-bottom:8px}
  .small{font-size:0.9rem;color:var(--muted)}
  .hidden{display:none!important}
</style>
</head>
<body>
<header class="header">
  <div class="logo">GPSP</div>
  <div style="font-weight:800">Student Portal</div>
</header>

<div class="container">
  <div id="loginPanel" class="card" style="max-width:520px;margin:22px auto">
    <h3>Student Login</h3>
    <form id="loginForm">
      <label>User ID<input id="userId" required></label>
      <label>Password<input id="password" type="password" required></label>
      <div style="margin-top:8px"><button class="btn" type="submit">Sign In</button></div>
      <p class="small">Demo: <strong>student1 / abcd</strong></p>
    </form>
  </div>

  <div id="dashboard" class="hidden">
    <div class="card">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <h3 id="welcome">Welcome</h3>
        <div><button id="logoutBtn" class="btn" style="background:linear-gradient(180deg,#475569,#2b3440)">Logout</button></div>
      </div>
      <p class="small">Class: <strong id="stuClass">4th</strong></p>
    </div>

    <div class="card">
      <h4>Your Assignments</h4>
      <div id="assignList" class="small">Loading...</div>
    </div>

    <div class="card">
      <h4>Available Quizzes</h4>
      <div id="quizList">Loading...</div>
    </div>

    <div class="card">
      <h4>Your Submissions</h4>
      <div id="subsList">Loading...</div>
    </div>
  </div>
</div>

<script>
  // Demo student
  const demo = {user:'student1', pass:'abcd', class:'4th'};
  document.getElementById('loginForm').addEventListener('submit', e=>{
    e.preventDefault();
    const u = document.getElementById('userId').value;
    const p = document.getElementById('password').value;
    if(u === demo.user && p === demo.pass){
      document.getElementById('loginPanel').classList.add('hidden');
      document.getElementById('dashboard').classList.remove('hidden');
      document.getElementById('welcome').textContent = 'Welcome, ' + u;
      document.getElementById('stuClass').textContent = demo.class;
      loadAssignments(); loadQuizzes(); loadSubs();
    } else alert('Invalid credentials (demo).');
  });

  document.getElementById('logoutBtn').addEventListener('click', ()=> location.reload());

  // load assignments for class
  function loadAssignments(){
    const tasks = JSON.parse(localStorage.getItem('teacherTasks') || '[]');
    const my = tasks.filter(t => t.class === demo.class);
    const area = document.getElementById('assignList');
    area.innerHTML = my.length ? my.map(a=>`<div class="feed-item"><strong>${a.title}</strong><div class="small">${a.class} • ${a.subject} • ${a.due?('Due: '+a.due):''}</div><p class="small">${a.details}</p></div>`).join('') : '<div class="small">No assignments for your class.</div>';
  }

  // load quizzes for class
  function loadQuizzes(){
    const qs = JSON.parse(localStorage.getItem('teacherQuizzes') || '[]');
    const my = qs.filter(q => q.class === demo.class);
    const area = document.getElementById('quizList');
    if(!my.length) { area.innerHTML = '<div class="small">No quizzes for your class.</div>'; return; }
    area.innerHTML = my.map((q, idx) => `
      <div class="feed-item">
        <strong>${q.title}</strong>
        <div class="small">${q.class} • ${q.subject} • ${q.due?('Due: '+q.due):''}</div>
        <p class="small">${q.question}</p>
        <div style="display:flex;gap:8px;margin-top:8px">
          <button class="btn" onclick="submitAnswer(${idx},'A')">A) ${q.optionA}</button>
          <button class="btn" onclick="submitAnswer(${idx},'B')">B) ${q.optionB}</button>
          <button class="btn" onclick="submitAnswer(${idx},'C')">C) ${q.optionC}</button>
        </div>
      </div>`).join('');
    // store current filtered quizzes for submission indexes
    window.__quizzes = my;
  }

  function submitAnswer(index, choice){
    const q = window.__quizzes[index];
    if(!q) return alert('Quiz not found.');
    const answer = String(choice).trim().toUpperCase();
    const correct = String(q.correct || '').trim().toUpperCase();
    const subs = JSON.parse(localStorage.getItem('studentSubs') || '[]');
    subs.unshift({student:demo.user, quizTitle:q.title, answer:answer, correct:correct, time:Date.now()});
    localStorage.setItem('studentSubs', JSON.stringify(subs));
    alert('Submitted. Your answer: ' + answer + (answer === correct ? ' (Correct)' : ' (Wrong)'));
    loadSubs();
  }

  function loadSubs(){
    const subs = JSON.parse(localStorage.getItem('studentSubs') || '[]').filter(s => s.student === demo.user);
    const area = document.getElementById('subsList');
    area.innerHTML = subs.length ? subs.map(s => `<div class="feed-item"><strong>${s.quizTitle}</strong><div class="small">Answer: ${s.answer} • Correct: ${s.correct} • ${new Date(s.time).toLocaleString()}</div></div>`).join('') : '<div class="small">No submissions yet.</div>';
  }
</script>
</body>
</html>
