<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Student Portal – Government Primary School Pethgam Wagoora</title>

<style>
/* Matches teacher style (Colour Style 3 + Background Animation + 3D buttons) */
:root{
  --accent:#0f766e; --accent2:#ff6b6b; --accent3:#ffd166; --card-bg:rgba(255,255,255,0.92); --muted:#6b7280;
}
html,body{height:100%;margin:0;font-family:Inter,system-ui,Arial,sans-serif;background:linear-gradient(120deg,#f3fbfa 0%,#fff 40%,#f7fbff 100%);color:#042}
body::before,body::after{content:"";position:fixed;z-index:-1;filter:blur(60px);opacity:.6;pointer-events:none;}
body::before{width:420px;height:420px;left:-120px;top:-80px;background:radial-gradient(circle at 30% 30%, rgba(15,118,110,0.18),transparent 40%),radial-gradient(circle at 70% 70%, rgba(255,107,107,0.12),transparent 35%);animation:blobmove 12s ease-in-out infinite alternate;}
body::after{width:320px;height:320px;right:-100px;bottom:-60px;background:radial-gradient(circle at 20% 20%, rgba(255,209,102,0.12),transparent 40%),radial-gradient(circle at 80% 80%, rgba(15,118,110,0.08),transparent 35%);animation:blobmove 14s ease-in-out infinite alternate-reverse;}
@keyframes blobmove{from{transform:translateY(0) scale(1) rotate(0deg)}to{transform:translateY(18px) scale(1.06) rotate(6deg)}}

.header{display:flex;align-items:center;padding:14px 18px;background:linear-gradient(90deg,var(--accent),#06b6d4);color:white;box-shadow:0 8px 22px rgba(2,6,23,0.08)}
.logo-img{width:54px;height:54px;border-radius:8px;object-fit:cover;background:white;padding:6px}
.header h1{margin-left:12px;font-size:20px}

.container{max-width:980px;margin:20px auto;padding:16px}
.panel{background:var(--card-bg);padding:16px;border-radius:14px;box-shadow:0 12px 30px rgba(2,6,23,0.06);backdrop-filter:blur(6px);margin-top:18px}

.btn{display:inline-block;padding:10px 14px;border-radius:12px;border:none;font-weight:700;cursor:pointer;transition:all .15s ease;background:linear-gradient(180deg,var(--accent),#064e47);box-shadow:0 10px 20px rgba(12,74,70,0.18);color:#fff}
.btn:active{transform:translateY(3px);box-shadow:0 4px 10px rgba(12,74,70,0.12)}
.btn.alt{background:linear-gradient(180deg,var(--accent2),#e05555);box-shadow:0 10px 22px rgba(224,85,85,0.12)}

label{display:block;margin:8px 0;font-weight:600;color:#064e47}
input,select,textarea{width:100%;padding:10px;border-radius:10px;border:1px solid rgba(7,22,20,0.08);background:linear-gradient(180deg,rgba(255,255,255,0.95),#fafafa)}

.small{max-width:420px;margin:0 auto}
.notice{color:var(--muted);font-size:0.95rem;margin-top:8px}

.quiz-card, .task-item{background:#fff;padding:12px;border-radius:10px;margin:10px 0;box-shadow:0 6px 18px rgba(2,6,23,0.05)}
.leader-row{display:flex;justify-content:space-between;padding:6px 0;border-bottom:1px dashed #eee}
.center{text-align:center}
.hidden{display:none}
</style>
</head>
<body>

<!-- LOGIN SCREEN -->
<div id="loginScreen" class="small" style="margin-top:80px">
  <div class="panel">
    <div class="center">
      <!-- put your logo.png next to this file -->
      <img src="logo.png" alt="logo" class="logo-img">
      <h2>Student Login</h2>
    </div>

    <form id="loginForm">
      <label>User ID: <input id="stuUserId" required></label>
      <label>Password: <input id="stuPassword" type="password" required></label>
      <button class="btn" type="submit">Login</button>
      <div class="notice">Demo account — ID: <strong>student1</strong> / Password: <strong>stud123</strong></div>
    </form>
  </div>
</div>

<!-- DASHBOARD (hidden until login) -->
<div id="dashboard" class="hidden">
  <header class="header">
    <img src="logo.png" alt="logo" class="logo-img">
    <h1>Student Dashboard</h1>
    <div style="margin-left:auto; color:#fff; font-weight:700" id="studentNameDisplay"></div>
  </header>

  <div class="container">
    <!-- Student info -->
    <section class="panel">
      <h3>Your Info</h3>
      <div><strong>Name:</strong> <span id="stuName"></span></div>
      <div><strong>Class:</strong> <span id="stuClass"></span></div>
      <div style="margin-top:10px"><button id="logoutBtn" class="btn alt">Logout</button></div>
    </section>

    <!-- Assignments (filtered by class) -->
    <section class="panel">
      <h3>Assignments for your class</h3>
      <div id="assignmentsArea"></div>
    </section>

    <!-- Available quizzes -->
    <section class="panel">
      <h3>Quizzes for your class</h3>
      <div id="quizzesArea"></div>
    </section>

    <!-- Leaderboard -->
    <section class="panel">
      <h3>Leaderboard (Latest)</h3>
      <div id="leaderboardArea"></div>
    </section>
  </div>
</div>

<script>
/*
  Student login + quiz flow (demo)
  - Demo student account: student1 / stud123 (class "4th")
  - Quizzes are read from localStorage key "teacherQuizzes"
  - Assignments from "teacherTasks"
  - Scores saved to "studentScores" as: [{userId, quizTitle, score, total, time}]
*/

// ----- Demo accounts -----
// You can extend this list or switch to server auth later.
const demoStudents = [
  { userId: "student1", password: "stud123", name: "Student One", class: "4th" },
  // add more like: {userId:"student2", password:"p2", name:"Fatima", class:"5th"}
];

// helper
function $(id){ return document.getElementById(id); }

// LOGIN
document.getElementById('loginForm').addEventListener('submit', function(e){
  e.preventDefault();
  const uid = $('stuUserId').value.trim();
  const pwd = $('stuPassword').value.trim();
  const user = demoStudents.find(u => u.userId === uid && u.password === pwd);
  if(!user){
    alert('Invalid User ID or Password');
    return;
  }
  // success -> show dashboard and set context
  window.currentStudent = user;
  $('loginScreen').style.display = 'none';
  $('dashboard').classList.remove('hidden');

  $('stuName').textContent = user.name;
  $('stuClass').textContent = user.class;
  $('studentNameDisplay').textContent = user.name + ' • ' + user.class;

  renderAssignments();
  renderQuizzes();
  renderLeaderboard();
});

// LOGOUT
$('logoutBtn').addEventListener('click', ()=> {
  window.currentStudent = null;
  $('dashboard').classList.add('hidden');
  $('loginScreen').style.display = '';
  $('loginForm').reset();
});

// LOAD assignments (filter by class)
function renderAssignments(){
  const tasks = JSON.parse(localStorage.getItem('teacherTasks')||'[]');
  const className = window.currentStudent?.class;
  const list = tasks.filter(t => (t.class || '') === className);
  const area = $('assignmentsArea');
  if(!list.length){ area.innerHTML = '<p>No assignments for your class.</p>'; return; }
  area.innerHTML = list.map(t => `
    <div class="task-item">
      <strong>${t.title}</strong><br>
      Subject: ${t.subject} <small> • ${new Date(t.time).toLocaleString()}</small>
      <div style="margin-top:8px">${t.details}</div>
    </div>
  `).join('');
}

// RENDER quizzes (filter by class) and allow taking them
function renderQuizzes(){
  const quizzes = JSON.parse(localStorage.getItem('teacherQuizzes')||'[]');
  const className = window.currentStudent?.class;
  const list = quizzes.filter(q => (q.class || '') === className);
  const area = $('quizzesArea');
  if(!list.length){ area.innerHTML = '<p>No quizzes for your class.</p>'; return; }

  area.innerHTML = list.map((q,idx) => `
    <div class="quiz-card" id="quiz_card_${idx}">
      <strong>${q.title}</strong> <br>
      Subject: ${q.subject} <small> • ${new Date(q.time).toLocaleString()}</small>
      <div style="margin-top:8px"><strong>Q:</strong> ${q.question}</div>
      <form data-quiz-idx="${idx}" class="takeQuizForm" style="margin-top:10px">
        <label><input type="radio" name="q${idx}" value="A"> A) ${q.optionA}</label>
        <label><input type="radio" name="q${idx}" value="B"> B) ${q.optionB}</label>
        <label><input type="radio" name="q${idx}" value="C"> C) ${q.optionC}</label>
        <div style="margin-top:8px">
          <button type="submit" class="btn">Submit Answer</button>
          <button type="button" class="btn alt" onclick="showCorrect('${idx}')">Show Answer</button>
        </div>
      </form>
      <div id="quiz_result_${idx}" style="margin-top:8px"></div>
    </div>
  `).join('');

  // attach handlers
  document.querySelectorAll('.takeQuizForm').forEach(form=>{
    form.addEventListener('submit', function(ev){
      ev.preventDefault();
      const qi = parseInt(this.getAttribute('data-quiz-idx'),10);
      const q = list[qi];
      // get chosen radio (values are 'A'|'B'|'C')
      const sel = this.querySelector('input[type=radio]:checked');
      if(!sel){ alert('Please select an option.'); return; }
      const chosen = sel.value;
      // Compare with stored correct (expected to be 'A'|'B'|'C')
      const correct = q.correct;
      const score = (chosen === correct) ? 1 : 0;
      // save result
      const scores = JSON.parse(localStorage.getItem('studentScores')||'[]');
      scores.push({ userId: window.currentStudent.userId, name: window.currentStudent.name, quizTitle: q.title, score, total:1, time: Date.now() });
      localStorage.setItem('studentScores', JSON.stringify(scores));
      // show result
      $('quiz_result_' + qi).innerHTML = `<div style="font-weight:700">${ score ? 'Correct ✅' : 'Incorrect ❌' } — Correct: ${correct}</div>`;
      // update leaderboard
      renderLeaderboard();
    });
  });
}

// show correct answer (helper)
function showCorrect(index){
  const quizzes = JSON.parse(localStorage.getItem('teacherQuizzes')||'[]');
  const className = window.currentStudent?.class;
  const list = quizzes.filter(q => (q.class || '') === className);
  const q = list[index];
  if(q) alert('Correct answer: ' + q.correct);
}

// Simple leaderboard (top recent attempts)
function renderLeaderboard(){
  const scores = JSON.parse(localStorage.getItem('studentScores')||'[]');
  if(!scores.length){ $('leaderboardArea').innerHTML = '<p>No quiz attempts yet.</p>'; return; }
  // show latest 10
  const recent = scores.slice(-50).reverse().slice(0,10);
  $('leaderboardArea').innerHTML = recent.map(s=>`<div class="leader-row"><div>${s.name} — ${s.quizTitle}</div><div>${s.score}/${s.total}</div></div>`).join('');
}

// If you want to prefill sample quizzes/tasks (for first-time demo), uncomment and run once:
(function ensureDemoData(){
  // only add demo data if there is no data yet
  if(!localStorage.getItem('teacherQuizzes')){
    const demoQuizzes = [
      { title:'Math Quick 1', class:'4th', subject:'Mathematics', question:'What is 7 + 5?', optionA:'10', optionB:'12', optionC:'13', correct:'B', time: Date.now() },
      { title:'English Quiz 1', class:'4th', subject:'English', question:'Choose the correct plural of "child".', optionA:'childs', optionB:'childes', optionC:'children', correct:'C', time: Date.now() }
    ];
    localStorage.setItem('teacherQuizzes', JSON.stringify(demoQuizzes));
  }
  if(!localStorage.getItem('teacherTasks')){
    const demoTasks = [
      { title:'EVS Worksheet', class:'4th', subject:'EVS', details:'Complete worksheet pages 5-7', time: Date.now() }
    ];
    localStorage.setItem('teacherTasks', JSON.stringify(demoTasks));
  }
})();
</script>
</body>
</html>
